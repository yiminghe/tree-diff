{"version":3,"sources":["webpack:///./src/diff.js?4612","webpack:///./src/ChildOperationTypes.js?af21","webpack:///./src/patch.js?2cda","webpack:///./examples/renderDOM.js","webpack:///./src/dom/index.js","webpack:///./src/dom/dom.js","webpack:///./src/dom/renderDOM.js","webpack:///./src/dom/createDOMNode.js","webpack:///./src/dom/patchDOM.js"],"names":["diffTree","indexOf","nodes","node","isSame","nodeIndex","len","length","i","nativeShould","a","b","sortByIndex","fromIndex","diff","fromNodes","afterNodes","options","internal","shouldUpdate","childrenKey","fromPath","parentNode","insertQueue","updateQueue","removeQueue","lastIndex","tmp","forEach","afterNode","toIndex","fromNode","push","type","concat","toPath","Math","max","sort","o","currentChildren","nextChildren","ret","MOVE","UPDATE","REMOVE","NEW","patch","processNew","processUpdate","processMove","processRemove","q","moves","join","simplifyOperations","operations","JSON","parse","stringify","k","v","undefined","vdom1","container","document","createElement","getElementById","appendChild","update","onclick","console","log","default","dom","props","children","key","getDefaultKeyFromIndex","index","prevElement","nextElement","prevElementIndex","nextElementIndex","prevEmpty","nextEmpty","prevType","nextType","renderDOM","vdom_","root","vdom","Array","isArray","n","c","currentVDom","nextVDom_","nextVDom","queue","createDOMNode","doc","createTextNode","name","hasOwnProperty","setAttribute","child","findNodeByPath","parent","reduce","p","childNodes","newNode","insertBefore","_","removeChild","nodeValue","currentProps","nextProps","nextName","nextValue","currentValue","currentName","removeAttribute","patchDOM","bind"],"mappings":"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","file":"renderDOM.js","sourcesContent":["import { UPDATE, MOVE, REMOVE, NEW } from './ChildOperationTypes';\n\nfunction indexOf(nodes, node, isSame, nodeIndex) {\n  const len = nodes.length;\n  for (let i = 0; i < len; i++) {\n    if (isSame(node, nodes[i], nodeIndex, i)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction nativeShould(a, b) {\n  return a === b;\n}\n\nfunction sortByIndex(a, b) {\n  if (a.fromIndex === b.fromIndex) {\n    return 0;\n  }\n  return a.fromIndex > b.fromIndex ? -1 : 1;\n}\n\n// diff by level\nfunction diff(fromNodes, afterNodes, options = {}, internal = {}) {\n  const { shouldUpdate = nativeShould, childrenKey = 'children' } = options;\n  const { fromPath = [], parentNode } = internal;\n  let insertQueue = [];\n  let updateQueue = [];\n  let removeQueue = [];\n  let lastIndex = 0;\n  let tmp;\n  afterNodes.forEach((afterNode, toIndex) => {\n    const fromIndex = indexOf(fromNodes, afterNode, shouldUpdate, toIndex);\n    if (fromIndex !== -1) {\n      const fromNode = fromNodes[fromIndex];\n      updateQueue.push({\n        type: UPDATE,\n        fromNode,\n        afterNode,\n        parentNode,\n        fromIndex,\n        fromPath: fromPath.concat(fromIndex),\n      });\n      if (fromIndex < lastIndex) {\n        tmp = {\n          type: MOVE,\n          fromNode,\n          afterNode,\n          parentNode,\n          fromIndex,\n          toIndex,\n          fromPath: fromPath.concat(fromIndex),\n          toPath: fromPath.concat(toIndex),\n        };\n        insertQueue.push(tmp);\n        removeQueue.push(tmp);\n      }\n      lastIndex = Math.max(fromIndex, lastIndex);\n    } else {\n      insertQueue.push({\n        type: NEW,\n        afterNode,\n        parentNode,\n        toIndex,\n        toPath: fromPath.concat(toIndex),\n      });\n    }\n  });\n\n  fromNodes.forEach((fromNode, fromIndex) => {\n    const toIndex = indexOf(afterNodes, fromNode, shouldUpdate, fromIndex);\n    if (toIndex === -1) {\n      removeQueue.push({\n        type: REMOVE,\n        fromNode,\n        parentNode,\n        fromIndex,\n        fromPath: fromPath.concat(fromIndex),\n      });\n    }\n  });\n\n  removeQueue.sort(sortByIndex);\n\n  if (childrenKey) {\n    updateQueue.concat().forEach((o) => {\n      const currentChildren = o.fromNode[childrenKey] || [];\n      const nextChildren = o.afterNode[childrenKey] || [];\n      // bottom up\n      const ret = diff(currentChildren, nextChildren, options, {\n        fromPath: o.fromPath,\n        parentNode: o.fromNode,\n      });\n      insertQueue = ret.insertQueue.concat(insertQueue);\n      updateQueue = ret.updateQueue.concat(updateQueue);\n      removeQueue = ret.removeQueue.concat(removeQueue);\n    });\n  }\n\n  return {\n    insertQueue,\n    updateQueue,\n    removeQueue,\n  };\n}\n\nexport default function diffTree(fromNodes, afterNodes, options) {\n  return diff(fromNodes, afterNodes, options);\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/diff.js\n **/","export const MOVE = 'move';\nexport const UPDATE = 'update';\nexport const REMOVE = 'remove';\nexport const NEW = 'new';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/ChildOperationTypes.js\n **/","import { MOVE, NEW } from './ChildOperationTypes';\n\nfunction patch({ removeQueue, insertQueue, updateQueue }, {\n  processNew,\n  processUpdate,\n  processMove,\n  processRemove,\n}) {\n  updateQueue.forEach((q) => {\n    processUpdate(q);\n  });\n\n  const moves = {};\n\n  removeQueue.forEach((q) => {\n    const ret = processRemove(q);\n    if (q.type === MOVE) {\n      moves[q.toPath.join(',')] = ret;\n    }\n  });\n\n  insertQueue.forEach((q) => {\n    if (q.type === NEW) {\n      processNew(q);\n    } else if (q.type === MOVE) {\n      processMove(q, moves[q.toPath.join(',')]);\n    }\n  });\n}\n\nexport default patch;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/patch.js\n **/","/** @jsx dom */\n\n/* eslint no-console:0 */\n\nimport { dom, renderDOM } from 'tree-diff/src/dom/';\n\nfunction simplifyOperations(operations) {\n  return JSON.parse(JSON.stringify(operations, (k, v) => {\n    return k === 'children' || k === 'props' ? undefined : v;\n  }));\n}\n\n(() => {\n  const vdom1 = (<div>\n    <h2>no key</h2>\n    <p id=\"1\">1</p>\n    <p id=\"2\">2</p>\n    <button id=\"t\">change</button>\n  </div>);\n  const container = document.createElement('div');\n  document.getElementById('__react-content').appendChild(container);\n\n  const { update } = renderDOM(vdom1, container);\n\n  document.getElementById('t').onclick = () => {\n    const operations = update(<div>\n      <h2>no key</h2>\n      <p id=\"2\">2</p>\n      <p id=\"1\">1</p>\n      <p id=\"3\">3</p>\n      <button id=\"t\">change</button>\n    </div>);\n    console.log('operations', (simplifyOperations(operations)));\n  };\n})();\n\n(() => {\n  const vdom1 = (<div>\n    <h2>with key</h2>\n    <p key=\"1\">1</p>\n    <p key=\"2\">2</p>\n    <button key=\"t\" id=\"t2\">change</button>\n  </div>);\n  const container = document.createElement('div');\n  document.getElementById('__react-content').appendChild(container);\n\n  const { update } = renderDOM(vdom1, container);\n\n  document.getElementById('t2').onclick = () => {\n    const operations = update(<div>\n      <h2>with key</h2>\n      <p key=\"2\">2</p>\n      <p key=\"1\">1</p>\n      <p key=\"3\">3</p>\n      <button key=\"t\" id=\"t\">change</button>\n    </div>);\n\n    console.log('operations', (simplifyOperations(operations)));\n  };\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./examples/renderDOM.js\n **/","export { default as dom } from './dom';\nexport { default as renderDOM } from './renderDOM';\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dom/index.js\n **/","export default function dom(type, props, ...children) {\n  const ret = {\n    type,\n    props,\n    children,\n  };\n  if (props && props.key) {\n    ret.key = props.key;\n    delete props.key;\n  }\n  return ret;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dom/dom.js\n **/","import diff from '../diff';\nimport createDOMNode from './createDOMNode';\nimport patchDOM from './patchDOM';\n\nfunction getDefaultKeyFromIndex(index) {\n  return `.${index}`;\n}\n\nfunction shouldUpdate(prevElement, nextElement, prevElementIndex, nextElementIndex) {\n  const prevEmpty = prevElement === null || prevElement === false;\n  const nextEmpty = nextElement === null || nextElement === false;\n  if (prevEmpty || nextEmpty) {\n    return prevEmpty === nextEmpty;\n  }\n\n  const prevType = typeof prevElement;\n  const nextType = typeof nextElement;\n  if (prevType === 'string' || prevType === 'number') {\n    return (nextType === 'string' || nextType === 'number');\n  }\n  return (\n    nextType === 'object' &&\n    prevElement.type === nextElement.type &&\n    (prevElement.key || getDefaultKeyFromIndex(prevElementIndex))\n    === (nextElement.key || getDefaultKeyFromIndex(nextElementIndex))\n  );\n}\n\nfunction renderDOM(vdom_, root) {\n  let vdom = vdom_;\n  if (!Array.isArray(vdom_)) {\n    vdom = [vdom_];\n  }\n  vdom.forEach((n) => {\n    const c = createDOMNode(n);\n    root.appendChild(c);\n  });\n  let currentVDom = vdom;\n  return {\n    update(nextVDom_) {\n      let nextVDom = nextVDom_;\n      if (!Array.isArray(nextVDom)) {\n        nextVDom = [nextVDom];\n      }\n      const queue = diff(currentVDom, nextVDom, { shouldUpdate });\n      currentVDom = nextVDom;\n      patchDOM(queue, root);\n      return queue;\n    },\n  };\n}\n\nexport default renderDOM;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dom/renderDOM.js\n **/","function createDOMNode(vdom, doc = document) {\n  if (typeof vdom === 'string') {\n    return doc.createTextNode(vdom);\n  }\n  const { type, props } = vdom;\n  const node = doc.createElement(type);\n  for (const name in props) {\n    if (props.hasOwnProperty(name)) {\n      node.setAttribute(name, props[name]);\n    }\n  }\n  if (vdom.children) {\n    vdom.children.forEach((c) => {\n      const child = createDOMNode(c, doc);\n      node.appendChild(child);\n    });\n  }\n  return node;\n}\n\nexport default createDOMNode;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dom/createDOMNode.js\n **/","import patch from '../patch';\nimport createDOMNode from './createDOMNode';\n\nfunction findNodeByPath(root, fromPath) {\n  let parent = root;\n  const node = fromPath.reduce(\n      (n, p) => {\n        parent = n;\n        return n.childNodes[p];\n      },\n      root) || null;\n  return {\n    node,\n    parent,\n  };\n}\n\nfunction processNew(root, q) {\n  const { afterNode, toPath } = q;\n  const newNode = createDOMNode(afterNode);\n  const { parent, node } = findNodeByPath(root, toPath);\n  parent.insertBefore(newNode, node);\n}\n\nfunction processMove(_, q, { parent, node }) {\n  const { toPath } = q;\n  parent.insertBefore(node, parent.childNodes[toPath[toPath.length - 1]] || null);\n}\n\nfunction processRemove(root, q) {\n  const { fromPath } = q;\n  const { parent, node } = findNodeByPath(root, fromPath);\n  parent.removeChild(node);\n  return { parent, node };\n}\n\nfunction processUpdate(root, q) {\n  const { fromPath, fromNode, afterNode } = q;\n  const { node } = findNodeByPath(root, fromPath);\n  if (typeof afterNode === 'string') {\n    if (afterNode !== fromNode) {\n      node.nodeValue = afterNode;\n    }\n    return;\n  }\n  const currentProps = fromNode.props;\n  const nextProps = afterNode.props;\n  for (const nextName in nextProps) {\n    if (nextProps.hasOwnProperty(nextName)) {\n      const nextValue = nextProps[nextName];\n      const currentValue = currentProps[nextName];\n      if (nextValue !== currentValue) {\n        node.setAttribute(nextName, nextValue);\n      }\n    }\n  }\n  for (const currentName in currentProps) {\n    if (currentProps.hasOwnProperty(currentName) && !nextProps.hasOwnProperty(currentName)) {\n      node.removeAttribute(currentName);\n    }\n  }\n}\n\nfunction patchDOM(queue, root) {\n  patch(queue, {\n    processNew: processNew.bind(null, root),\n    processMove: processMove.bind(null, root),\n    processUpdate: processUpdate.bind(null, root),\n    processRemove: processRemove.bind(null, root),\n  });\n}\n\nexport default patchDOM;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dom/patchDOM.js\n **/"],"sourceRoot":""}